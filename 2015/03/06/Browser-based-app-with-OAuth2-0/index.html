<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="author" content="John Doe"><meta name="description"><title>Browser based app with OAuth2.0&mdash;Hexo</title><link href="/favicon.png" rel="icon"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom.xml"><link href="http://fonts.googleapis.com/css?family=Open+Sans:400" rel="stylesheet"><link href="http://fonts.googleapis.com/css?family=Source+Code+Pro:400,600" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/stylesheets/app.css"></head><body><header id="page-header"><div id="masthead"><h1 id="site-title"><a href="/">Hexo</a></h1><p id="site-slogan"></p></div></header><section id="content"><article class="post"><h2>Browser based app with OAuth2.0</h2><div class="meta">Mar 6 2015</div><p>First party browser based apps are often registered, but untrusted clients.<br>But, does it matter if it’s untrusted? Even if the redirect_uri is to an untrusted domain, the only way a client can get a valid accesstoken is by having a user log in with valid username/password.</p>
<p>  +—————+<br>  | Resource |<br>  |  Owner   |<br>  |          |<br>  +—————+<br>       v<br>       |    Resource Owner<br>      (A) Password Credentials<br>       |<br>       v<br>  +————-+                                  +———————-+<br>  |         |&gt;—(B)—— Resource Owner ———-&gt;|               |<br>  |         |         Password Credentials     | Authorization |<br>  | Client  |                                  |     Server    |<br>  |         |&lt;—(C)—— Access Token ————-&lt;|               |<br>  |         |        (w/ Refresh Token)        |               |<br>  |         |                                  |               |<br>  |         |&gt;—(Da)—-    API Call    ———-&gt;|               |<br>  |         |         (w/ Access Token)        |               |<br>  |         |                                  |               |<br>  |         |&gt;—(Db)—  Refresh Token  ———-&gt;|               |<br>  |         |&lt;—(Eb)—- Access Token ————-&lt;|               |<br>  |         |        (w/ Refresh Token)        |               |<br>  +————-+                                  +———————-+</p>
<pre><code>     <span class="title">Figure</span> <span class="number">5</span>: Resource Owner Password Credentials Flow
</code></pre><p>The flow illustrated in Figure 5 includes the following steps:</p>
<p>(A)  The resource owner provides the client with its username and<br>     password.</p>
<p>(B)  The client requests an access token from the authorization<br>     server’s token endpoint by including the credentials received<br>     from the resource owner.  When making the request, the client<br>     authenticates with the authorization server.<br>     Includes encrypted accesstoken payload with:<br>        _user, _client, created, token, ipAddr<br>     Includes encrypted refreshtoken payload with:<br>        _user, _client, created, token, ipAddr</p>
<p>(C)  The authorization server authenticates the client and validates<br>     the resource owner credentials, and if valid, issues an access<br>     token.</p>
<p>(Da) API Call happens before Access Token expiration</p>
<p>(Db) The client requests an access token from the authorization<br>     server’s token endpoint by including the refresh token received<br>     from before.<br>(Eb) The authorization server authenticates the client and validates<br>     the resource owner credentials, and if valid, issues a new<br>     access token.</p>
<p>AccessToken only:<br>expires: 2 weeks<br>hacker gains control without user knowing. has access for 2 weeks. Needs to log back in with username/pass after 2 weeks.</p>
<p>Access+Refresh Token:<br>expires: 2 hours<br>hacker gains control without user knowing. has access for 2 hours but also has refreshtoken.</p>
<p>Better explanation:<br><a href="http://stackoverflow.com/a/12885823/1925955" target="_blank" rel="external">http://stackoverflow.com/a/12885823/1925955</a></p>
</article><nav id="article-pagination"><a href="/2015/03/15/Oauth2-for-1st-party-clients/" title="Previous article: Oauth2 for 1st party clients" class="prev">&larr; Previous article</a><a href="/2015/02/10/keyboard/" title="Next article: custom keyboard" class="next">Next article &rarr;</a></nav></section><footer id="page-footer"><section><nav id="footer-menu"><ul><li><a href="/about">About</a></li><li><a href="/archives">Archive</a></li><li><a href="http://github.com/widatama/hexo-jade-barebone">Source</a></li><li><a href="/atom.xml">Feed</a></li></ul></nav></section></footer></body></html>